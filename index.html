<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BTC 5M Oracle â€¢ Chainlink Data</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âš¡</text></svg>">

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Azeret+Mono:wght@400;500;600;700;900&family=Outfit:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

    <style>
        *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
        :root{
            --bg:#06060a;--s1:#0c0c12;--s2:#121218;--s3:#1a1a22;--s4:#24242e;
            --border:rgba(255,255,255,0.05);--bh:rgba(255,255,255,0.10);
            --t1:#eeeef0;--t2:#8a8a9a;--t3:#4a4a58;
            --bull:#00e676;--bull-d:rgba(0,230,118,0.12);
            --bear:#ff1744;--bear-d:rgba(255,23,68,0.12);
            --amber:#ffab00;--amber-d:rgba(255,171,0,0.10);
            --poly:#4c6ef5;--poly-d:rgba(76,110,245,0.10);
            --ff:'Outfit',sans-serif;--fm:'Azeret Mono',monospace;
        }
        body{background:var(--bg);color:var(--t1);font-family:var(--ff);min-height:100vh;overflow-x:hidden;-webkit-font-smoothing:antialiased}
        body::before{content:'';position:fixed;inset:0;background:linear-gradient(rgba(255,171,0,0.015) 1px,transparent 1px),linear-gradient(90deg,rgba(255,171,0,0.015) 1px,transparent 1px);background-size:60px 60px;pointer-events:none;z-index:0}
        body::after{content:'';position:fixed;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(ellipse at 30% 20%,rgba(255,171,0,0.04),transparent 50%),radial-gradient(ellipse at 80% 80%,rgba(0,230,118,0.03),transparent 40%);pointer-events:none;z-index:0}
        .app{position:relative;z-index:1;max-width:1440px;margin:0 auto;padding:0 10px}
        .card{background:var(--s1);border:1px solid var(--border);border-radius:14px;transition:border-color 0.3s}.card:hover{border-color:var(--bh)}
        ::-webkit-scrollbar{width:4px;height:4px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--s4);border-radius:4px}
        .hdr{position:sticky;top:0;z-index:50;background:rgba(6,6,10,0.85);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 10px}
        .hdr-in{max-width:1440px;margin:0 auto;height:48px;display:flex;align-items:center;justify-content:space-between}
        .m{font-family:var(--fm)}
        .dot{width:6px;height:6px;border-radius:50%;display:inline-block}
        .dot-on{background:var(--bull);box-shadow:0 0 6px var(--bull)}.dot-w{background:var(--amber)}.dot-off{background:var(--t3)}
        .badge{display:inline-flex;align-items:center;gap:4px;padding:2px 7px;border-radius:5px;font-size:9px;font-weight:700;font-family:var(--fm);letter-spacing:0.03em}
        .chart-w{position:relative;height:340px;width:100%}
        @media(max-width:768px){.chart-w{height:220px}}
        @keyframes fu{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
        @keyframes fg{0%{color:var(--bull)}100%{color:var(--t1)}}
        @keyframes fr{0%{color:var(--bear)}100%{color:var(--t1)}}
        @keyframes si{from{opacity:0;transform:translateX(16px)}to{opacity:1;transform:translateX(0)}}
        @keyframes fo{to{opacity:0;transform:translateX(16px)}}
        .tz{position:fixed;top:56px;right:10px;z-index:200;display:flex;flex-direction:column;gap:5px;pointer-events:none}
        .toast{pointer-events:auto;padding:8px 14px;border-radius:8px;font-size:11px;font-weight:600;display:flex;align-items:center;gap:6px;animation:si 0.3s ease-out,fo 0.3s ease 3.5s forwards;box-shadow:0 6px 20px rgba(0,0,0,0.5);font-family:var(--fm)}
        .tw{background:#0a2e1a;border:1px solid #14532d;color:#86efac}
        .tl{background:#2e0a0a;border:1px solid #450a0a;color:#fca5a5}
        .ti{background:#0a0a2e;border:1px solid #1e1b4b;color:#c7d2fe}
        .tk{background:#2e1f0a;border:1px solid #422006;color:#fde68a}
        .ind{display:flex;align-items:center;justify-content:space-between;padding:5px 8px;border-radius:6px;background:var(--s2);border:1px solid var(--border);font-size:10px;font-family:var(--fm)}
        .tabs{display:flex;gap:2px;background:var(--s2);border-radius:7px;padding:2px}
        .tab{padding:4px 10px;border-radius:5px;font-size:10px;font-weight:700;font-family:var(--fm);cursor:pointer;transition:all 0.2s;color:var(--t3);background:transparent;border:none}
        .tab.a{background:var(--s4);color:var(--t1)}.tab:not(.a):hover{color:var(--t2)}
        .pb{border-color:rgba(0,230,118,0.2)!important;box-shadow:0 0 40px -10px rgba(0,230,118,0.15)}
        .pr{border-color:rgba(255,23,68,0.2)!important;box-shadow:0 0 40px -10px rgba(255,23,68,0.15)}
        .ob{display:flex;height:5px;border-radius:3px;overflow:hidden;background:var(--s3)}
        .ob-u{background:var(--bull);transition:width 0.5s}.ob-d{background:var(--bear);transition:width 0.5s}
        .bb{position:relative;overflow:hidden;border-radius:11px;padding:12px;font-weight:800;cursor:pointer;border:1px solid;transition:all 0.15s;font-family:var(--ff);font-size:14px;text-align:center}
        .bb:active{transform:scale(0.96)}
        .bb-u{background:linear-gradient(135deg,rgba(0,230,118,0.10),rgba(0,230,118,0.03));border-color:rgba(0,230,118,0.15);color:var(--bull)}
        .bb-u:hover{border-color:rgba(0,230,118,0.35)}
        .bb-d{background:linear-gradient(135deg,rgba(255,23,68,0.10),rgba(255,23,68,0.03));border-color:rgba(255,23,68,0.15);color:var(--bear)}
        .bb-d:hover{border-color:rgba(255,23,68,0.35)}
        .ht{width:100%;text-align:left;font-size:10px;border-collapse:collapse}
        .ht th{padding:7px 10px;font-size:9px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:0.08em;font-family:var(--fm);background:var(--s2);position:sticky;top:0;z-index:2}
        .ht td{padding:7px 10px;border-bottom:1px solid var(--border);font-family:var(--fm);color:var(--t2)}
        .ht tr:hover td{background:rgba(255,255,255,0.015)}
        .st{font-size:10px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:0.1em;font-family:var(--fm);margin-bottom:8px;display:flex;align-items:center;gap:5px}
        .pl{display:inline-flex;align-items:center;gap:4px;padding:4px 9px;border-radius:6px;background:var(--poly-d);border:1px solid rgba(76,110,245,0.15);color:#8da4ff;font-size:10px;font-weight:700;font-family:var(--fm);text-decoration:none;transition:all 0.2s}
        .pl:hover{background:rgba(76,110,245,0.15);color:#a8bdff}
        .rw{position:relative;display:flex;align-items:center;justify-content:center}
        .rw svg{transform:rotate(-90deg)}
        @media(min-width:1024px){.gt{grid-template-columns:1fr 190px 1fr}.gb{grid-template-columns:1fr 1fr}}
        .g{display:grid;gap:10px}
        .hm{display:none}@media(min-width:768px){.hm{display:flex}}
    </style>
</head>
<body>
<div id="tz" class="tz"></div>
<header class="hdr"><div class="hdr-in">
    <div style="display:flex;align-items:center;gap:8px">
        <div style="width:30px;height:30px;background:linear-gradient(135deg,#ffab00,#ff6d00);border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:14px;box-shadow:0 3px 10px rgba(255,171,0,0.25)"><i class="fa-brands fa-bitcoin" style="color:#fff"></i></div>
        <div><div class="m" style="font-size:11px;font-weight:900;line-height:1">BTC/USD</div><div class="m" style="font-size:7px;color:var(--t3);font-weight:600;letter-spacing:0.05em">5-MINUTE ORACLE</div></div>
    </div>
    <div style="display:flex;align-items:center;gap:5px">
        <span class="badge hm" style="background:var(--poly-d);border:1px solid rgba(76,110,245,0.15);color:#8da4ff"><i class="fa-solid fa-link" style="font-size:7px"></i> CHAINLINK</span>
        <span class="badge" style="background:var(--bull-d);border:1px solid rgba(0,230,118,0.12);color:var(--bull)"><i class="dot dot-on"></i><span id="ls">LIVE</span></span>
        <button onclick="tgS()" id="sbt" style="background:transparent;border:none;color:var(--amber);font-size:16px;cursor:pointer;padding:4px 8px;transition:opacity 0.2s;opacity:0.8"><i class="fa-solid fa-volume-high"></i></button>
    </div>
</div></header>

<main class="app" style="padding-top:10px;padding-bottom:40px">
<div class="g">
<!-- TOP ROW -->
<div class="g gt" style="align-items:start">
    <div class="card" style="padding:14px 16px">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">
            <div class="m" style="font-size:10px;color:var(--t3);font-weight:700;letter-spacing:0.08em">LIVE PRICE</div>
            <span id="wl" class="badge" style="background:var(--s3);color:var(--t3)">READY</span>
        </div>
        <div style="display:flex;align-items:baseline;gap:8px;margin-bottom:6px">
            <div class="m" style="font-size:38px;font-weight:900;line-height:1;letter-spacing:-0.02em" id="cp">â€”</div>
            <div class="m" style="font-size:13px;font-weight:700" id="c24">â€”</div>
        </div>
        <div style="display:flex;gap:8px;margin-top:12px">
            <div style="flex:1"><div class="m" style="font-size:8px;color:var(--t3);margin-bottom:3px">5M HIGH</div><div class="m" style="font-size:11px;font-weight:700;color:var(--bull)" id="h5">â€”</div></div>
            <div style="flex:1"><div class="m" style="font-size:8px;color:var(--t3);margin-bottom:3px">5M LOW</div><div class="m" style="font-size:11px;font-weight:700;color:var(--bear)" id="l5">â€”</div></div>
            <div style="flex:1"><div class="m" style="font-size:8px;color:var(--t3);margin-bottom:3px">VOLATILITY</div><div class="m" style="font-size:11px;font-weight:700" id="v5">â€”</div></div>
        </div>
    </div>
    
    <div class="card" style="padding:14px 16px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px">
        <div class="rw" style="width:96px;height:96px">
            <svg width="96" height="96"><circle cx="48" cy="48" r="38" fill="none" stroke="var(--s3)" stroke-width="8"/><circle id="rf" cx="48" cy="48" r="38" fill="none" stroke="var(--amber)" stroke-width="8" stroke-linecap="round" stroke-dasharray="238.76" stroke-dashoffset="238.76" style="transition:stroke 0.3s"/></svg>
            <div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center"><div class="m" style="font-size:20px;font-weight:900;color:var(--amber)" id="cd">â€”</div></div>
        </div>
        <div class="m" style="font-size:8px;color:var(--t3);text-align:center;font-weight:600" id="wr">â€”</div>
    </div>
    
    <div class="card" style="padding:14px 16px">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">
            <div class="m" style="font-size:10px;color:var(--t3);font-weight:700;letter-spacing:0.08em">ACCURACY</div>
            <span id="cs" class="badge" style="background:var(--s3);color:var(--t3)">WAITING</span>
        </div>
        <div style="display:flex;align-items:baseline;gap:4px;margin-bottom:6px">
            <div class="m" style="font-size:38px;font-weight:900;line-height:1;letter-spacing:-0.02em"><span id="sp">--</span><span style="font-size:18px;color:var(--t3)">%</span></div>
        </div>
        <div style="display:flex;gap:8px;margin-top:12px">
            <div style="flex:1"><div class="m" style="font-size:8px;color:var(--t3);margin-bottom:3px">WINS</div><div class="m" style="font-size:11px;font-weight:700;color:var(--bull)" id="sw">0</div></div>
            <div style="flex:1"><div class="m" style="font-size:8px;color:var(--t3);margin-bottom:3px">LOSSES</div><div class="m" style="font-size:11px;font-weight:700;color:var(--bear)" id="sl">0</div></div>
            <div style="flex:1"><div class="m" style="font-size:8px;color:var(--t3);margin-bottom:3px">TOTAL</div><div class="m" style="font-size:11px;font-weight:700" id="st">0</div></div>
        </div>
    </div>
</div>

<!-- MAIN ROW -->
<div class="g gb" style="align-items:start">
    <div class="card" id="pc" style="padding:18px 20px">
        <div style="display:flex;align-items:start;gap:14px;margin-bottom:14px">
            <div id="pi" style="width:48px;height:48px;border-radius:12px;background:var(--s3);display:flex;align-items:center;justify-content:center;font-size:20px;color:var(--t3);flex-shrink:0;transition:all 0.4s"><i class="fa-solid fa-hourglass-half"></i></div>
            <div style="flex:1"><div style="font-size:9px;color:var(--t3);margin-bottom:4px;font-weight:700;letter-spacing:0.1em;font-family:var(--fm)">NEXT 5 MIN</div><div class="m" style="font-size:24px;font-weight:900;line-height:1.1;margin-bottom:4px;color:var(--t3)" id="pt">WAIT</div><div class="m" style="font-size:10px;color:var(--t2)" id="pf">Confidence: --%</div></div>
        </div>
        <div style="margin-bottom:10px"><div class="m" style="font-size:8px;color:var(--t3);margin-bottom:4px">SIGNAL PRICE</div><div class="m" style="font-size:13px;font-weight:700" id="is">â€”</div></div>
        <div class="ob"><div class="ob-u" id="ou"></div><div class="ob-d" id="od"></div></div>
    </div>
    
    <div class="card" style="padding:18px 20px">
        <div class="st"><i class="fa-solid fa-chart-line" style="font-size:9px"></i> TECHNICAL INDICATORS</div>
        <div style="display:flex;flex-direction:column;gap:5px">
            <div class="ind"><span style="color:var(--t2)">RSI (14)</span><span id="ir" class="m" style="font-weight:700">â€”</span></div>
            <div class="ind"><span style="color:var(--t2)">MACD</span><span id="im" class="m" style="font-weight:700">â€”</span></div>
            <div class="ind"><span style="color:var(--t2)">MA (20)</span><span id="ia" class="m" style="font-weight:700">â€”</span></div>
            <div class="ind"><span style="color:var(--t2)">Bollinger</span><span id="ib" class="m" style="font-weight:700">â€”</span></div>
            <div class="ind"><span style="color:var(--t2)">5M Momentum</span><span id="imo" class="m" style="font-weight:700">â€”</span></div>
            <div class="ind"><span style="color:var(--t2)">Volatility</span><span id="iv" class="m" style="font-weight:700">â€”</span></div>
        </div>
    </div>
</div>

<!-- CHART -->
<div class="card" style="padding:18px 20px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px">
        <div class="st" style="margin:0"><i class="fa-solid fa-chart-area" style="font-size:9px"></i> PRICE CHART</div>
        <div class="tabs">
            <button class="tab a" onclick="sT(this,'5m')" data-i="5m">5M</button>
            <button class="tab" onclick="sT(this,'1h')" data-i="1h">1H</button>
            <button class="tab" onclick="sT(this,'6h')" data-i="6h">6H</button>
        </div>
    </div>
    <div class="chart-w"><canvas id="ch"></canvas></div>
</div>

<!-- MANUAL CALLS -->
<div class="card" style="padding:18px 20px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px">
        <div class="st" style="margin:0"><i class="fa-solid fa-hand-pointer" style="font-size:9px"></i> MANUAL CALLS <span id="ms" style="color:var(--t2);font-weight:400">0W / 0L</span></div>
        <button onclick="cMB()" style="background:transparent;border:1px solid var(--border);color:var(--t3);padding:3px 8px;border-radius:5px;font-size:9px;font-weight:700;font-family:var(--fm);cursor:pointer;transition:all 0.2s">CLEAR</button>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:14px">
        <button onclick="pMB('UP')" class="bb bb-u"><i class="fa-solid fa-arrow-trend-up"></i> CALL UP</button>
        <button onclick="pMB('DOWN')" class="bb bb-d"><i class="fa-solid fa-arrow-trend-down"></i> CALL DOWN</button>
    </div>
    <div id="ml" style="max-height:300px;overflow-y:auto"></div>
</div>
</div>
</main>

<script>
// STATE
let ch,lp=0,pH=[],cP=null,st={w:0,l:0},snd=true,mB=[],cI='5m';

// INIT
(async()=>{
    try{const s=localStorage.getItem('b5s');if(s!==null)snd=JSON.parse(s);uSB()}catch(e){}
    try{const b=localStorage.getItem('b5b4');if(b)mB=JSON.parse(b);rMB()}catch(e){}
    rSt();iC();sCd();
    await fP();
    setInterval(async()=>{
        const n=new Date(),m=n.getMinutes(),s=n.getSeconds();
        if(m%5===0&&s<2){await fP()}
    },2000);
})();

// FETCH PRICE
async function fP(){
    try{
        const r=await fetch('https://min-api.cryptocompare.com/data/v2/histominute?fsym=BTC&tsym=USD&limit=100&aggregate=5');
        const d=await r.json();
        if(d.Response==='Success'&&d.Data&&d.Data.Data){
            pH=d.Data.Data.map(c=>({t:c.time*1000,p:c.close,o:c.open,h:c.high,l:c.low,v:c.volumeto}));
            lp=pH[pH.length-1].p;
            document.getElementById('ls').textContent='LIVE';
            document.getElementById('ls').parentElement.style.background='var(--bull-d)';
            document.getElementById('ls').parentElement.style.color='var(--bull)';
            uUI();uC();aT();mP();cLP();
        }
    }catch(e){
        console.error(e);
        document.getElementById('ls').textContent='ERROR';
        document.getElementById('ls').parentElement.style.background='var(--bear-d)';
        document.getElementById('ls').parentElement.style.color='var(--bear)';
        setTimeout(fP,10000);
    }
}

// UPDATE UI
function uUI(){
    const p=pH.map(x=>x.p),r20=p.slice(-20),h=Math.max(...r20),l=Math.min(...r20),o=p[p.length-20]||p[0],c=((lp-o)/o)*100,vl=((h-l)/lp)*100;
    document.getElementById('cp').textContent='$'+N(lp);
    const ch24=document.getElementById('c24');ch24.textContent=(c>=0?'+':'')+c.toFixed(2)+'%';ch24.style.color=c>=0?'var(--bull)':'var(--bear)';
    document.getElementById('h5').textContent='$'+N(h);
    document.getElementById('l5').textContent='$'+N(l);
    document.getElementById('v5').textContent=vl.toFixed(2)+'%';
    rMyB(lp);
}

// CHART
function iC(){
    const ctx=document.getElementById('ch').getContext('2d');
    ch=new Chart(ctx,{type:'line',data:{labels:[],datasets:[{data:[],borderColor:'#ffab00',backgroundColor:'rgba(255,171,0,0.05)',borderWidth:2,tension:0.4,fill:true,pointRadius:0,pointHoverRadius:4}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{mode:'index',intersect:false,backgroundColor:'rgba(12,12,18,0.95)',borderColor:'rgba(255,255,255,0.1)',borderWidth:1,padding:10,displayColors:false,callbacks:{title:()=>'',label:c=>'$'+N(c.parsed.y)}}},scales:{x:{display:false},y:{position:'right',grid:{color:'rgba(255,255,255,0.03)'},ticks:{color:'var(--t3)',font:{size:9,family:'Azeret Mono'},callback:v=>'$'+Math.round(v).toLocaleString()}}},interaction:{mode:'nearest',axis:'x',intersect:false}}});
}
function uC(){
    if(!ch||!pH.length)return;
    let d=pH;
    if(cI==='1h')d=pH.filter((_,i)=>i%12===0);
    else if(cI==='6h')d=pH.filter((_,i)=>i%72===0);
    ch.data.labels=d.map(x=>new Date(x.t).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'}));
    ch.data.datasets[0].data=d.map(x=>x.p);
    ch.update('none');
}
function sT(b,i){
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('a'));
    b.classList.add('a');cI=i;uC();
}

// TECHNICAL ANALYSIS
function aT(){
    if(pH.length<20)return;
    const p=pH.map(x=>x.p),l20=p.slice(-20);
    const rsi=cRSI(p.slice(-15),14),ma=l20.reduce((a,b)=>a+b,0)/l20.length,e12=cEMA(p,12),e26=cEMA(p,26),macd=e12-e26;
    const sd=cSD(l20,ma),ub=ma+2*sd,lb=ma-2*sd;
    const m5=((lp-p[p.length-2])/p[p.length-2])*10000,vl=((Math.max(...l20)-Math.min(...l20))/lp)*10000;
    const ta={rsi,ma,macd,boll:lp>ub?'OB':lp<lb?'OS':'N',mom:m5,vol:vl,n:(m5>0?1:-1)*(rsi<30||rsi>70?0.8:0.5)};
    uI(ta);uOdS(ta);
}
function cRSI(p,n){let g=0,l=0;for(let i=1;i<Math.min(p.length,n+1);i++){const c=p[i]-p[i-1];c>0?g+=c:l-=c}const ag=g/n,al=l/n;return al===0?100:100-100/(1+ag/al)}
function cEMA(p,n){const k=2/(n+1);let e=p[0];for(let i=1;i<p.length;i++)e=p[i]*k+e*(1-k);return e}
function cSD(p,m){const d=p.map(x=>Math.pow(x-m,2));return Math.sqrt(d.reduce((a,b)=>a+b,0)/p.length)}

// PREDICTION
function mP(){
    if(pH.length<20)return;
    const p=pH.map(x=>x.p),l20=p.slice(-20);
    const rsi=cRSI(p.slice(-15),14),ma=l20.reduce((a,b)=>a+b,0)/l20.length,e12=cEMA(p,12),e26=cEMA(p,26),macd=e12-e26;
    const sd=cSD(l20,ma),ub=ma+2*sd,lb=ma-2*sd;
    const m5=((lp-p[p.length-2])/p[p.length-2])*100,m10=((lp-p[p.length-3])/p[p.length-3])*100;
    const pc=[];for(let i=p.length-5;i<p.length;i++)if(i>0)pc.push(p[i]-p[i-1]);
    const apc=pc.reduce((a,b)=>a+b,0)/pc.length;
    
    let bu=0,be=0;
    if(rsi<30)bu+=3;else if(rsi<40)bu+=2;else if(rsi<50)bu+=1;else if(rsi>70)be+=3;else if(rsi>60)be+=2;else if(rsi>50)be+=1;
    if(macd>0&&macd>e26*0.001)bu+=3;else if(macd>0)bu+=1;else if(macd<0&&macd<-e26*0.001)be+=3;else if(macd<0)be+=1;
    const pma=((lp-ma)/ma)*100;if(pma>0.5)bu+=2;else if(pma>0)bu+=1;else if(pma<-0.5)be+=2;else if(pma<0)be+=1;
    if(lp<lb)bu+=2;else if(lp>ub)be+=2;
    if(m5>0.3)bu+=4;else if(m5>0.1)bu+=2;else if(m5<-0.3)be+=4;else if(m5<-0.1)be+=2;
    if(m10>0.5)bu+=2;else if(m10<-0.5)be+=2;
    if(apc>lp*0.0005)bu+=3;else if(apc<-lp*0.0005)be+=3;
    
    const ts=bu+be,cf=ts>0?Math.abs(bu-be)/ts*100:50;
    const rc=[];for(let i=Math.max(0,p.length-10);i<p.length;i++)if(i>0)rc.push(Math.abs(p[i]-p[i-1]));
    const am=rc.reduce((a,b)=>a+b,0)/rc.length;
    
    let dir,tp;
    if(bu>be){dir='UP';tp=lp+am}else if(be>bu){dir='DOWN';tp=lp-am}else{dir='SIDEWAYS';tp=lp}
    
    if(!cP||Date.now()>=cP.we){
        cP={st:Date.now(),sp:lp,dir,tp,conf:Math.round(cf),we:gNW()};
        svSt();uPUI(cP);
        toast(`ðŸŽ¯ ${dir} signal @ $${N(lp)}`,dir==='UP'?'w':'l');
        pSnd('l');
        document.getElementById('wl').textContent='ACTIVE';
        document.getElementById('wl').style.background='var(--amber-d)';
        document.getElementById('wl').style.color='var(--amber)';
    }
}
function gNW(){const n=new Date(),m=n.getMinutes();n.setMinutes(m-(m%5)+5,0,0);return n.getTime()}

// CHECK LAST PREDICTION
function cLP(){
    if(!cP||Date.now()<cP.we)return;
    const a=lp>=cP.sp?'UP':'DOWN',w=cP.dir===a;
    if(w){st.w++;pSnd('w');toast('âœ… WIN: '+cP.dir,'w')}else{st.l++;pSnd('lo');toast('âŒ LOSS: '+cP.dir,'l')}
    document.getElementById('st').textContent=st.w+st.l;
    uSt();cP=null;localStorage.removeItem('b5p');rPUI();
    document.getElementById('wl').textContent='READY';
    document.getElementById('wl').style.background='var(--s3)';
    document.getElementById('wl').style.color='var(--t3)';
}

// UPDATE INDICATORS
function uI(ta){
    $t('ir',ta.rsi.toFixed(2),ta.rsi>70?'var(--bear)':ta.rsi<30?'var(--bull)':'var(--t1)');
    $t('ia','$'+ta.ma.toFixed(2),lp>ta.ma?'var(--bull)':'var(--bear)');
    $t('ib',ta.boll,ta.boll==='OB'?'var(--bear)':ta.boll==='OS'?'var(--bull)':'var(--t1)');
    $t('im',(ta.macd>0?'+':'')+ta.macd.toFixed(2),ta.macd>0?'var(--bull)':'var(--bear)');
    $t('imo',(ta.mom>0?'+':'')+ta.mom.toFixed(1)+' bps',ta.mom>0?'var(--bull)':'var(--bear)');
    $t('iv',ta.vol.toFixed(1)+' bps',ta.vol>50?'var(--amber)':'var(--t1)');
}
function uOdS(ta){const u=Math.max(15,Math.min(85,Math.round(50+ta.n*40)));uOd(u,100-u)}
function uOd(u,d){document.getElementById('ou').style.width=u+'%';document.getElementById('od').style.width=d+'%'}

// PREDICTION UI
function uPUI(p){
    const c=document.getElementById('pc'),ic=document.getElementById('pi'),tx=document.getElementById('pt');
    document.getElementById('cs').textContent='LOCKED';document.getElementById('cs').style.background='var(--bull-d)';document.getElementById('cs').style.color='var(--bull)';
    tx.textContent=p.dir;document.getElementById('pf').textContent=`Confidence: ${p.conf}%`;document.getElementById('is').textContent='$'+N(p.sp);
    if(p.dir==='UP'){tx.style.color='var(--bull)';ic.style.background='var(--bull-d)';ic.style.color='var(--bull)';ic.innerHTML='<i class="fa-solid fa-arrow-trend-up"></i>';c.className='card pb'}
    else if(p.dir==='DOWN'){tx.style.color='var(--bear)';ic.style.background='var(--bear-d)';ic.style.color='var(--bear)';ic.innerHTML='<i class="fa-solid fa-arrow-trend-down"></i>';c.className='card pr'}
    else{tx.style.color='var(--amber)';ic.style.background='var(--amber-d)';ic.style.color='var(--amber)';ic.innerHTML='<i class="fa-solid fa-minus"></i>';c.className='card'}
}
function rPUI(){
    document.getElementById('pc').className='card';
    const i=document.getElementById('pi');i.style.cssText='width:48px;height:48px;border-radius:12px;background:var(--s3);display:flex;align-items:center;justify-content:center;font-size:20px;color:var(--t3);flex-shrink:0;transition:all 0.4s';i.innerHTML='<i class="fa-solid fa-hourglass-half"></i>';
    document.getElementById('pt').textContent='WAIT';document.getElementById('pt').style.color='var(--t3)';
    document.getElementById('pf').textContent='Confidence: --%';document.getElementById('cs').textContent='WAITING';document.getElementById('cs').style.background='var(--s3)';document.getElementById('cs').style.color='var(--t3)';document.getElementById('is').textContent='â€”';
}

// COUNTDOWN
function sCd(){
    const ci=2*Math.PI*38;
    setInterval(()=>{
        const n=new Date(),ts=n.getMinutes()*60+n.getSeconds(),iw=ts%300,r=299-iw;
        document.getElementById('cd').textContent=`${Math.floor(r/60)}:${(r%60).toString().padStart(2,'0')}`;
        document.getElementById('rf').setAttribute('stroke-dashoffset',ci*(1-iw/300));
        const rf=document.getElementById('rf'),ce=document.getElementById('cd');
        if(r<20){rf.style.stroke='var(--bear)';ce.style.color='var(--bear)'}else{rf.style.stroke='var(--amber)';ce.style.color='var(--amber)'}
        const sm=n.getMinutes()-(n.getMinutes()%5),w1=new Date(n);w1.setMinutes(sm,0,0);const w2=new Date(w1);w2.setMinutes(w1.getMinutes()+5);
        document.getElementById('wr').textContent=w1.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})+' â†’ '+w2.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
    },1000);
}

// MANUAL BETS
function pMB(d){
    if(!lp)return toast('âš  Waiting for price...','i');
    const n=new Date(),mn=n.getMinutes(),we=new Date(n);we.setMinutes(mn-(mn%5)+5,0,0);
    mB.unshift({id:'M-'+Date.now(),time:n.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit',second:'2-digit'}),dir:d,price:lp,we:we.getTime(),result:'PENDING'});
    if(mB.length>50)mB.pop();localStorage.setItem('b5b4',JSON.stringify(mB));rMB();
    toast(`ðŸ“ ${d} @ $${N(lp)}`,d==='UP'?'w':'l');pSnd('l');
}
function rMyB(ep){
    let c=false;mB.forEach(b=>{if(b.result==='PENDING'&&Date.now()>=b.we-5000){const a=ep>=b.price?'UP':'DOWN';b.result=b.dir===a?'WIN':'LOSS';b.ep=ep;c=true}});
    if(c){localStorage.setItem('b5b4',JSON.stringify(mB));rMB()}
}
function rMB(){
    const el=document.getElementById('ml'),w=mB.filter(b=>b.result==='WIN').length,l=mB.filter(b=>b.result==='LOSS').length;
    document.getElementById('ms').textContent=`${w}W / ${l}L`;
    if(!mB.length){el.innerHTML='<div style="text-align:center;color:var(--t3);font-size:10px;margin-top:24px">Place a call to start tracking.</div>';return}
    el.innerHTML=mB.slice(0,25).map(b=>{
        const dc=b.dir==='UP'?'var(--bull)':'var(--bear)',ic=b.dir==='UP'?'fa-arrow-trend-up':'fa-arrow-trend-down',bg=b.dir==='UP'?'var(--bull-d)':'var(--bear-d)';
        let bd='<span class="badge" style="background:var(--s3);color:var(--t3)">PEND</span>';
        if(b.result==='WIN')bd='<span class="badge" style="background:var(--bull-d);color:var(--bull)">WIN âœ“</span>';
        else if(b.result==='LOSS')bd='<span class="badge" style="background:var(--bear-d);color:var(--bear)">LOSS âœ—</span>';
        return`<div style="display:flex;justify-content:space-between;align-items:center;padding:6px 8px;border-radius:8px;background:var(--s2);border:1px solid var(--border);margin-bottom:3px"><div style="display:flex;align-items:center;gap:6px"><div style="width:26px;height:26px;border-radius:7px;background:${bg};display:flex;align-items:center;justify-content:center"><i class="fa-solid ${ic}" style="font-size:10px;color:${dc}"></i></div><div><div class="m" style="font-size:10px;color:${dc};font-weight:700">${b.dir} <span style="color:var(--t3);font-weight:400">@ $${N(b.price)}</span></div><div class="m" style="font-size:8px;color:var(--t3)">${b.time}</div></div></div>${bd}</div>`;
    }).join('');
}
function cMB(){if(!mB.length)return;mB=[];localStorage.setItem('b5b4',JSON.stringify(mB));rMB();toast('ðŸ—‘ Cleared','i')}

// STATE
function svSt(){if(cP)localStorage.setItem('b5p',JSON.stringify(cP));else localStorage.removeItem('b5p')}
function rSt(){const s=localStorage.getItem('b5p');if(!s)return;try{const p=JSON.parse(s);if(Date.now()<p.we){cP=p;uPUI(p);document.getElementById('wl').textContent='ACTIVE';document.getElementById('wl').style.background='var(--amber-d)';document.getElementById('wl').style.color='var(--amber)'}else localStorage.removeItem('b5p')}catch(e){}}

// STATS
function uSt(){document.getElementById('sw').textContent=st.w;document.getElementById('sl').textContent=st.l;const t=st.w+st.l;document.getElementById('st').textContent=t;document.getElementById('sp').textContent=t?Math.round(st.w/t*100):'--'}

// SOUND
function tgS(){snd=!snd;localStorage.setItem('b5s',JSON.stringify(snd));uSB()}
function uSB(){const b=document.getElementById('sbt');b.innerHTML=snd?'<i class="fa-solid fa-volume-high"></i>':'<i class="fa-solid fa-volume-xmark"></i>';b.style.color=snd?'var(--amber)':'var(--t3)'}
function pSnd(t){if(!snd)return;try{const a=new(window.AudioContext||window.webkitAudioContext)(),o=a.createOscillator(),g=a.createGain();o.connect(g);g.connect(a.destination);g.gain.value=0.06;
    if(t==='w'){o.frequency.setValueAtTime(523,a.currentTime);o.frequency.setValueAtTime(659,a.currentTime+0.08);o.frequency.setValueAtTime(784,a.currentTime+0.16);g.gain.exponentialRampToValueAtTime(0.001,a.currentTime+0.4);o.start();o.stop(a.currentTime+0.4)}
    else if(t==='lo'){o.frequency.setValueAtTime(392,a.currentTime);o.frequency.setValueAtTime(311,a.currentTime+0.12);g.gain.exponentialRampToValueAtTime(0.001,a.currentTime+0.35);o.start();o.stop(a.currentTime+0.35)}
    else{o.frequency.setValueAtTime(587,a.currentTime);g.gain.exponentialRampToValueAtTime(0.001,a.currentTime+0.12);o.start();o.stop(a.currentTime+0.12)}}catch(e){}}

// TOAST
function toast(m,t='i'){const z=document.getElementById('tz'),e=document.createElement('div');e.className='toast t'+t;e.textContent=m;z.appendChild(e);setTimeout(()=>{if(e.parentNode)e.remove()},4000)}

// HELPERS
function N(v){return Number(v).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})}
function $t(id,t,c){const e=document.getElementById(id);if(e){e.textContent=t;if(c)e.style.color=c}}
</script>
</body>
</html>